The files belonging to this database system will be owned by user "postgres".
This user must also own the server process.

The database cluster will be initialized with locale "en_US.utf8".
The default database encoding has accordingly been set to "UTF8".
The default text search configuration will be set to "english".

Data page checksums are disabled.

fixing permissions on existing directory /var/lib/postgresql/data ... ok
creating subdirectories ... ok
selecting dynamic shared memory implementation ... posix
selecting default max_connections ... 100
selecting default shared_buffers ... 128MB
selecting default time zone ... UTC
creating configuration files ... ok
running bootstrap script ... ok
performing post-bootstrap initialization ... ok
syncing data to disk ... ok


Success. You can now start the database server using:

    pg_ctl -D /var/lib/postgresql/data -l logfile start

waiting for server to start....2025-11-24 03:33:05.956 UTC [42] LOG:  starting PostgreSQL 15.15 on x86_64-pc-linux-musl, compiled by gcc (Alpine 14.2.0) 14.2.0, 64-bit
2025-11-24 03:33:05.981 UTC [42] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
2025-11-24 03:33:06.029 UTC [45] LOG:  database system was shut down at 2025-11-24 03:33:05 UTC
2025-11-24 03:33:06.051 UTC [42] LOG:  database system is ready to accept connections
 done
server started
CREATE DATABASE


/usr/local/bin/docker-entrypoint.sh: running /docker-entrypoint-initdb.d/schema_v2.sql
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE INDEX
CREATE FUNCTION
CREATE TRIGGER
CREATE TRIGGER
CREATE FUNCTION
CREATE FUNCTION
CREATE TRIGGER
INSERT 0 8
INSERT 0 1
2025-11-24 03:33:08.346 UTC [55] ERROR:  function round(double precision, integer) does not exist at character 252
2025-11-24 03:33:08.346 UTC [55] HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2025-11-24 03:33:08.346 UTC [55] STATEMENT:  CREATE OR REPLACE VIEW leaderboard AS
	SELECT
	    u.id,
	    u.username,
	    u.display_name,
	    u.avatar_url,
	    u.elo_rating,
	    u.rank_tier,
	    u.level,
	    u.total_games,
	    u.wins,
	    u.losses,
	    CASE WHEN u.total_games > 0 THEN ROUND((u.wins::FLOAT / u.total_games::FLOAT) * 100, 2) ELSE 0 END as win_rate,
	    u.win_streak,
	    u.best_win_streak,
	    ROW_NUMBER() OVER (ORDER BY u.elo_rating DESC) as rank
	FROM users u
	WHERE u.is_banned = FALSE AND u.total_games >= 10
	ORDER BY u.elo_rating DESC;
